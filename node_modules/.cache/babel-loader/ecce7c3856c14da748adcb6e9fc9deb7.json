{"remainingRequest":"/Users/pavel/Projects/fyas/node_modules/babel-loader/lib/index.js!/Users/pavel/Projects/fyas/node_modules/eslint-loader/index.js??ref--14-0!/Users/pavel/Projects/fyas/src/store/auth.js","dependencies":[{"path":"/Users/pavel/Projects/fyas/src/store/auth.js","mtime":1636360029755},{"path":"/Users/pavel/Projects/fyas/babel.config.js","mtime":1636353948320},{"path":"/Users/pavel/Projects/fyas/node_modules/cache-loader/dist/cjs.js","mtime":1636352989548},{"path":"/Users/pavel/Projects/fyas/node_modules/babel-loader/lib/index.js","mtime":1636352990365},{"path":"/Users/pavel/Projects/fyas/node_modules/eslint-loader/index.js","mtime":1636352989599}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIi9Vc2Vycy9wYXZlbC9Qcm9qZWN0cy9meWFzL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yIjsKaW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUuanMiOwppbXBvcnQgcm91dGVyIGZyb20gJy4uL3JvdXRlcic7IC8vIGltcG9ydCBfIGZyb20gJ2xvZGFzaCcKCmV4cG9ydCBkZWZhdWx0IHsKICBzdGF0ZTogewogICAgdXNlcjogbnVsbAogIH0sCiAgbXV0YXRpb25zOiB7CiAgICBzZXRVc2VyOiBmdW5jdGlvbiBzZXRVc2VyKHN0YXRlLCBwYXlsb2FkKSB7CiAgICAgIHN0YXRlLnVzZXIgPSBwYXlsb2FkOwogICAgfSwKICAgIHNldFVzZXJEYXRhOiBmdW5jdGlvbiBzZXRVc2VyRGF0YShzdGF0ZSwgdXNlckRhdGEpIHsKICAgICAgbG9jYWxTdG9yYWdlLnRva2VuID0gdXNlckRhdGEudG9rZW47IC8vIHZhciBiYXNlNjRVcmwgPSB1c2VyRGF0YS50b2tlbi5zcGxpdCgnLicpWzFdCiAgICAgIC8vIHZhciBiYXNlNjQgPSBiYXNlNjRVcmwucmVwbGFjZSgnLScsICcrJykucmVwbGFjZSgnXycsICcvJykKICAgICAgLy8gdmFyIGVuY1Rva2VuID0gSlNPTi5wYXJzZSh3aW5kb3cuYXRvYihiYXNlNjQpKQogICAgICAvLyBsb2NhbFN0b3JhZ2UudXJvbGUgPSBlbmNUb2tlbi5yb2xlCiAgICB9CiAgfSwKICBhY3Rpb25zOiB7CiAgICBnZXRQYXNzOiBmdW5jdGlvbiBnZXRQYXNzKF9yZWYsIGVtYWlsKSB7CiAgICAgIHZhciBjb21taXQgPSBfcmVmLmNvbW1pdDsKICAgICAgY29tbWl0KCdzZXRMb2FkaW5nJywgdHJ1ZSk7CiAgICAgIHZhciBwYXlsb2FkID0gewogICAgICAgIGNvbXBhbnlfc2x1ZzogJ2RldicsCiAgICAgICAgZW1haWw6IGVtYWlsCiAgICAgIH07CgogICAgICB0aGlzLl92bS4kaHR0cC5wb3N0KCdhdXRoL25ld19zZXNzaW9uJywgcGF5bG9hZCkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSk7IC8vIGNvbW1pdCgnc2V0TG9hZGluZycsIGZhbHNlKQogICAgICAgIC8vIGNvbW1pdCgnc2V0VXNlckRhdGEnLCB7cGF5bG9hZDogcmVzcG9uc2UuZGF0YX0pCiAgICAgICAgLy8gY29tbWl0KCdzZXRNZXNzYWdlJywgJ9CS0Ysg0YPRgdC/0LXRiNC90L4g0LLQvtGI0LvQuCDQsiDRgdC40YHRgtC10LzRgycpCiAgICAgICAgLy8gcm91dGVyLnB1c2goJy8nKQogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICBjb21taXQoJ3NldExvYWRpbmcnLCBmYWxzZSk7CgogICAgICAgIGlmIChlcnJvci5yZXNwb25zZS5zdGF0dXMgPT09IDQwMSkgewogICAgICAgICAgY29tbWl0KCdzZXRFcnJvcicsIGVycm9yLnJlc3BvbnNlLmRhdGEubWVzc2FnZSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBsb2dpblVzZXI6IGZ1bmN0aW9uIGxvZ2luVXNlcihfcmVmMiwgdXNlcikgewogICAgICB2YXIgY29tbWl0ID0gX3JlZjIuY29tbWl0OwogICAgICBjb21taXQoJ3NldExvYWRpbmcnLCB0cnVlKTsKCiAgICAgIHRoaXMuX3ZtLiRodHRwLnBvc3QoJ2F1dGgvbG9naW4nLCB1c2VyKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIGNvbW1pdCgnc2V0TG9hZGluZycsIGZhbHNlKTsKICAgICAgICBjb21taXQoJ3NldFVzZXJEYXRhJywgewogICAgICAgICAgcGF5bG9hZDogcmVzcG9uc2UuZGF0YQogICAgICAgIH0pOwogICAgICAgIGNvbW1pdCgnc2V0TWVzc2FnZScsICfQktGLINGD0YHQv9C10YjQvdC+INCy0L7RiNC70Lgg0LIg0YHQuNGB0YLQtdC80YMnKTsKICAgICAgICByb3V0ZXIucHVzaCgnLycpOwogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHsKICAgICAgICBjb21taXQoJ3NldExvYWRpbmcnLCBmYWxzZSk7CgogICAgICAgIGlmIChlcnJvci5yZXNwb25zZS5zdGF0dXMgPT09IDQwMSkgewogICAgICAgICAgY29tbWl0KCdzZXRFcnJvcicsIGVycm9yLnJlc3BvbnNlLmRhdGEubWVzc2FnZSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICAvLyBjaGVja1Rva2VuOiBfLmRlYm91bmNlKGZ1bmN0aW9uICh7IGNvbW1pdCwgZGlzcGF0Y2ggfSwgcmV0cnlSZXF1ZXN0KSB7CiAgICAvLyAgIGlmICghdGhpcy5fdm0uJGh0dHAuZGVmYXVsdHMuaGVhZGVycy5jb21tb24uQXV0aG9yaXphdGlvbikgdGhpcy5fdm0uJGh0dHAuZGVmYXVsdHMuaGVhZGVycy5jb21tb24uQXV0aG9yaXphdGlvbiA9ICdCZWFyZXIgJyArIGxvY2FsU3RvcmFnZS50b2tlbgogICAgLy8gICB0aGlzLl92bS4kaHR0cAogICAgLy8gICAgIC5wb3N0KCdhdXRoL3JlZnJlc2gnLCB7J3JlZnJlc2gnOiBsb2NhbFN0b3JhZ2UucmVmcmVzaF90b2tlbn0pLnRoZW4ocmVzcG9uc2UgPT4gewogICAgLy8gICAgICAgY29tbWl0KCdzZXRVc2VyRGF0YScsIHtwYXlsb2FkOiByZXNwb25zZS5kYXRhLCByZXRyeVJlcXVlc3R9KQogICAgLy8gICAgIH0pCiAgICAvLyAgICAgLmNhdGNoKCgpID0+IHsKICAgIC8vICAgICAgIGRpc3BhdGNoKCdsb2dPdXQnKQogICAgLy8gICAgIH0pCiAgICAvLyB9LCA1MDApLAogICAgYXV0b0xvZ2luVXNlcjogZnVuY3Rpb24gYXV0b0xvZ2luVXNlcihfcmVmMywgcGF5bG9hZCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwoKICAgICAgcmV0dXJuIF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSgpIHsKICAgICAgICB2YXIgY29tbWl0OwogICAgICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlJChfY29udGV4dCkgewogICAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIGNvbW1pdCA9IF9yZWYzLmNvbW1pdDsKICAgICAgICAgICAgICAgIF90aGlzLl92bS4kaHR0cC5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vbi5BdXRob3JpemF0aW9uID0gJ0JlYXJlciAnICsgbG9jYWxTdG9yYWdlLnRva2VuOwogICAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDQ7CiAgICAgICAgICAgICAgICByZXR1cm4gY29tbWl0KCdzZXRVc2VyJywgcGF5bG9hZCk7CgogICAgICAgICAgICAgIGNhc2UgNDoKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sIF9jYWxsZWUpOwogICAgICB9KSkoKTsKICAgIH0sCiAgICBsb2dPdXQ6IGZ1bmN0aW9uIGxvZ091dChfcmVmNCkgewogICAgICB2YXIgY29tbWl0ID0gX3JlZjQuY29tbWl0OwogICAgICByb3V0ZXIucHVzaCgnL2xvZ2luJyk7CiAgICAgIGxvY2FsU3RvcmFnZS5jbGVhcigpOwogICAgICBjb21taXQoJ3NldFVzZXInLCBudWxsKTsKICAgIH0KICB9LAogIGdldHRlcnM6IHsKICAgIHVzZXI6IGZ1bmN0aW9uIHVzZXIoc3RhdGUpIHsKICAgICAgcmV0dXJuIHN0YXRlLnVzZXI7CiAgICB9CiAgfQp9Ow=="},{"version":3,"sources":["/Users/pavel/Projects/fyas/src/store/auth.js"],"names":["router","state","user","mutations","setUser","payload","setUserData","userData","localStorage","token","actions","getPass","email","commit","company_slug","_vm","$http","post","then","response","console","log","catch","error","status","data","message","loginUser","push","autoLoginUser","defaults","headers","common","Authorization","logOut","clear","getters"],"mappings":"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","sourcesContent":["import router from '../router'\n// import _ from 'lodash'\n\nexport default {\n  state: {\n    user: null\n  },\n  mutations: {\n    setUser (state, payload) {\n      state.user = payload\n    },\n    setUserData (state, userData) {\n      localStorage.token = userData.token\n      // var base64Url = userData.token.split('.')[1]\n      // var base64 = base64Url.replace('-', '+').replace('_', '/')\n      // var encToken = JSON.parse(window.atob(base64))\n      // localStorage.urole = encToken.role\n    }\n  },\n  actions: {\n    getPass ({commit}, email) {\n      commit('setLoading', true)\n      let payload = {\n        company_slug: 'dev',\n        email\n      }\n      this._vm.$http\n      .post('auth/new_session', payload)\n      .then(response => {\n        console.log(response)\n        // commit('setLoading', false)\n        // commit('setUserData', {payload: response.data})\n        // commit('setMessage', 'Вы успешно вошли в систему')\n        // router.push('/')\n      })\n      .catch(error => {\n        commit('setLoading', false)\n        if (error.response.status === 401) {\n          commit('setError', error.response.data.message)\n        }\n      })\n    },\n    loginUser ({commit}, user) {\n      commit('setLoading', true)\n      this._vm.$http\n      .post('auth/login', user)\n      .then(response => {\n        commit('setLoading', false)\n        commit('setUserData', {payload: response.data})\n        commit('setMessage', 'Вы успешно вошли в систему')\n        router.push('/')\n      })\n      .catch(error => {\n        commit('setLoading', false)\n        if (error.response.status === 401) {\n          commit('setError', error.response.data.message)\n        }\n      })\n    },\n    // checkToken: _.debounce(function ({ commit, dispatch }, retryRequest) {\n    //   if (!this._vm.$http.defaults.headers.common.Authorization) this._vm.$http.defaults.headers.common.Authorization = 'Bearer ' + localStorage.token\n    //   this._vm.$http\n    //     .post('auth/refresh', {'refresh': localStorage.refresh_token}).then(response => {\n    //       commit('setUserData', {payload: response.data, retryRequest})\n    //     })\n    //     .catch(() => {\n    //       dispatch('logOut')\n    //     })\n    // }, 500),\n\n    async autoLoginUser ({commit}, payload) {\n      this._vm.$http.defaults.headers.common.Authorization = 'Bearer ' + localStorage.token\n      await commit('setUser', payload)\n    },\n\n    logOut ({commit}) {\n      router.push('/login')\n      localStorage.clear()\n      commit('setUser', null)\n    }\n  },\n\n  getters: {\n    user (state) {\n      return state.user\n    }\n  }\n}\n"]}]}